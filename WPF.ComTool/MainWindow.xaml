<Window x:Class="WPF.ComTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:LayUI="clr-namespace:LayUI.Wpf.Controls;assembly=LayUI.Wpf"
        xmlns:convert="clr-namespace:WPF.ComTool.Converters"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:WPF.ComTool"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:WPF.ComTool.ViewModels"
        Title="MainWindow"
        Width="1210"
        Height="780"
        d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"
        AllowsTransparency="True"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        mc:Ignorable="d">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <Window.Resources>
        <convert:BoolToPortStatusText x:Key="BoolToPortStatusText" />
        <convert:BoolToParamsEnabled x:Key="BoolToParamsEnabled" />
        <convert:BoolToRippleType x:Key="BoolToRippleType" />
    </Window.Resources>

    <Grid>
        <LayUI:LayTitleBar Background="{DynamicResource LighCyan}"
                           CornerRadius="8"
                           ResizeMode="CanResize">
            <LayUI:LayTitleBar.Header>
                <Border Height="40">
                    <TextBlock Margin="15,0,0,0"
                               HorizontalAlignment="Left"
                               FontFamily="HarmonyOS Sans SC"
                               FontWeight="Bold"
                               Foreground="White"
                               Text="ComTool" />
                </Border>
            </LayUI:LayTitleBar.Header>
            <Border BorderBrush="{DynamicResource Black}" BorderThickness="0,1,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <LayUI:LayCard Background="{DynamicResource LighCyan}"
                                   FontSize="16"
                                   Foreground="White"
                                   Header="串口调试工具">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <UniformGrid Margin="0,0,0,5"
                                         Columns="2"
                                         IsEnabled="{Binding CurrentSession.IsOpen, Converter={StaticResource BoolToParamsEnabled}}"
                                         Rows="5">
                                <TextBlock Text="串口：" />
                                <LayUI:LayComboBox Height="24"
                                                   Margin="0,3,5,0"
                                                   ItemsSource="{Binding SerialConfig.Port}"
                                                   SelectedItem="{Binding CurrentSession.Port}" />
                                <TextBlock Text="波特率:" />
                                <LayUI:LayComboBox Height="24"
                                                   Margin="0,3,5,0"
                                                   ItemsSource="{Binding SerialConfig.BaudRate}"
                                                   SelectedItem="{Binding CurrentSession.BaudRate}" />
                                <TextBlock Text="数据位:" />
                                <LayUI:LayComboBox Height="24"
                                                   Margin="0,3,5,0"
                                                   ItemsSource="{Binding SerialConfig.DataBit}"
                                                   SelectedItem="{Binding CurrentSession.DataBit}" />
                                <TextBlock Text="校验位:" />
                                <LayUI:LayComboBox Height="24"
                                                   Margin="0,3,5,0"
                                                   ItemsSource="{Binding SerialConfig.ParityBit}"
                                                   SelectedItem="{Binding CurrentSession.ParityBit}" />
                                <TextBlock Text="停止位:" />
                                <LayUI:LayComboBox Height="24"
                                                   Margin="0,3,5,5"
                                                   ItemsSource="{Binding SerialConfig.StopBit}"
                                                   SelectedItem="{Binding CurrentSession.StopBit}" />

                            </UniformGrid>

                            <LayUI:LayRipple Grid.Row="2"
                                             Margin="5,0,0,0"
                                             HorizontalAlignment="Center"
                                             Type="{Binding CurrentSession.IsOpen, Converter={StaticResource BoolToRippleType}}">
                                <LayUI:LayButton Width="Auto"
                                                 Command="{Binding OpenPortCommand}"
                                                 Content="{Binding CurrentSession.IsOpen, Converter={StaticResource BoolToPortStatusText}}"
                                                 Cursor="Hand"
                                                 Type="Default" />
                            </LayUI:LayRipple>

                            <LayUI:LayLegend Grid.Row="3"
                                             Margin="0,5,0,0"
                                             Header="接收区属性">
                                <WrapPanel>
                                    <LayUI:LayCheckBox Margin="0,0,5,0"
                                                       Content="十六进制"
                                                       Foreground="White"
                                                       IsChecked="{Binding CurrentSession.ReceiveFormatHex}" />
                                    <LayUI:LayButton Command="{Binding ClearDataReceivedCommand}"
                                                     Content="清空接收区"
                                                     Cursor="Hand"
                                                     Type="Default" />
                                </WrapPanel>
                            </LayUI:LayLegend>

                            <LayUI:LayLegend Grid.Row="4"
                                             Margin="0,5,0,0"
                                             Header="发送区属性">
                                <WrapPanel>
                                    <LayUI:LayCheckBox Margin="0,0,5,0"
                                                       Content="十六进制"
                                                       Foreground="White"
                                                       IsChecked="{Binding CurrentSession.SendFormatHex}" />
                                    <LayUI:LayButton Command="{Binding ClearDataSendCommand}"
                                                     Content="清空发送区"
                                                     Cursor="Hand"
                                                     Type="Default" />
                                </WrapPanel>
                            </LayUI:LayLegend>

                        </Grid>
                    </LayUI:LayCard>

                    <LayUI:LayNoticeBar Grid.Row="1"
                                        Grid.ColumnSpan="2"
                                        Margin="5,10"
                                        Padding="10"
                                        VerticalAlignment="Top"
                                        BorderBrush="{DynamicResource Gradient}"
                                        BorderThickness="1">
                        <LayUI:LayNoticeBar.InnerLeftContent>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock FontSize="16"
                                           Foreground="White"
                                           Text="发送：" />
                                <TextBlock FontSize="16"
                                           Foreground="White"
                                           Text="{Binding CurrentSession.SendCount}" />
                                <TextBlock FontSize="16"
                                           Foreground="White"
                                           Text="接收：" />
                                <TextBlock FontSize="16"
                                           Foreground="White"
                                           Text="{Binding CurrentSession.ReceiveCount}" />

                            </StackPanel>
                        </LayUI:LayNoticeBar.InnerLeftContent>
                    </LayUI:LayNoticeBar>

                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="5*" />
                            <RowDefinition Height="2*" />
                        </Grid.RowDefinitions>

                        <TextBox Grid.Row="0"
                                 Width="Auto"
                                 Margin="5"
                                 IsReadOnly="True"
                                 Text="{Binding CurrentSession.DataReceived}"
                                 TextWrapping="Wrap" />

                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="9*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <TextBox Margin="5" Text="{Binding CurrentSession.DataSend}" />
                            <LayUI:LayRipple Grid.Column="1"
                                             VerticalAlignment="Center"
                                             Type="Auto">
                                <LayUI:LayButton Width="Auto"
                                                 Command="{Binding SendCommand}"
                                                 Content="发送"
                                                 Cursor="Hand"
                                                 Type="Default" />
                            </LayUI:LayRipple>

                        </Grid>

                    </Grid>
                </Grid>

            </Border>
        </LayUI:LayTitleBar>
    </Grid>

</Window>